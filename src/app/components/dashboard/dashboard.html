<div class="dashboard-container">
  <!-- Header & Logo -->
  <a href="https://cotiviti.sharepoint.com/SitePages/welcome.aspx" target="_blank">
    <div class="logo-ribbon">
      <img
        class="image-logo"
        src="data:image/png;base64,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"
        alt="Logo"
      />
    </div>
  </a>

  <!-- User Header -->
  <h2 class="user-title">{{ username }}'s Claims</h2>

  <!-- Bulk Actions (only visible if at least one claim is selected) -->
<div class="bulk-actions-container">
  <!-- Delete Selected only shows if claims are selected -->
  <button 
    *ngIf="hasSelectedClaims()" 
    class="delete-selected-btn" 
    (click)="deleteSelectedClaims()">
    üóëÔ∏è Delete Selected
  </button>

  <!-- Export PDF always visible -->
  <button class="export-btn" (click)="exportToPDF()">üìÑ Export PDF</button>
</div>


  <!-- Claims Table -->
  <table class="claims-table">
    <thead>
      <tr>
        <th><input type="checkbox" (change)="toggleSelectAll($event)" [checked]="areAllSelected()" /></th>
        <th (click)="sortClaims('descriptioncode')">Description <span>{{ getSortIcon('descriptioncode') }}</span></th>
        <th (click)="sortClaims('procedurecode')">Procedure <span>{{ getSortIcon('procedurecode') }}</span></th>
        <th (click)="sortClaims('price')">Price <span>{{ getSortIcon('price') }}</span></th>
        <th (click)="sortClaims('datesubmitted')">Submitted On <span>{{ getSortIcon('datesubmitted') }}</span></th>
        <th>Actions</th>
      </tr>
      <tr class="column-filters">
        <th></th>
        <th><input type="text" placeholder="Search Description" [(ngModel)]="descriptionFilter" (input)="applyFiltersAndSorting()" /></th>
        <th><input type="text" placeholder="Search Procedure" [(ngModel)]="procedureFilter" (input)="applyFiltersAndSorting()" /></th>
        <th><input type="text" placeholder="Search Price" [(ngModel)]="priceFilter" (input)="applyFiltersAndSorting()" /></th>
        <th><input type="text" placeholder="Search Date" [(ngModel)]="dateFilter" (input)="applyFiltersAndSorting()" /></th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let claim of filteredClaims; trackBy: trackByClaimId" [ngClass]="{'high-price': claim.price > 5000}">
        <td><input type="checkbox" [(ngModel)]="claim.selected" (change)="checkSelectionChange()" /></td>

        <!-- Edit Mode -->
        <ng-container *ngIf="editingClaim && editingClaim.claimid === claim.claimid; else displayMode">
          <td><input [(ngModel)]="editingClaim.descriptioncode" /></td>
          <td><input [(ngModel)]="editingClaim.procedurecode" /></td>
          <td>
            <input type="number" [(ngModel)]="editingClaim.price" />
            <span *ngIf="editingClaim.price > 5000" class="warning-text">‚ö†Ô∏è High Price! Verify manually.</span>
          </td>
          <td>{{ editingClaim.datesubmitted | date:'short' }}</td>
          <td>
            <button (click)="updateClaim()">Save</button>
            <button (click)="cancelEdit()">Cancel</button>
          </td>
        </ng-container>

        <!-- Display Mode -->
        <ng-template #displayMode>
          <td>{{ claim.descriptioncode }}</td>
          <td>{{ claim.procedurecode }}</td>
          <td>
            {{ claim.price }}
            <span *ngIf="claim.price > 5000" class="warning-text">‚ö†Ô∏è High Price! Verify manually.</span>
          </td>
          <td>{{ claim.datesubmitted | date:'short' }}</td>
          <td>
            <button class="edit-btn" (click)="editClaim(claim)">Edit</button>
            <button class="delete-btn" (click)="deleteClaim(claim.claimid)">Delete</button>
          </td>
        </ng-template>
      </tr>
    </tbody>
  </table>

  <!-- Add New Claim Form -->
  <div class="add-claim-form">
    <h3>Add New Claim</h3>
    <input type="text" [(ngModel)]="newClaim.descriptioncode" placeholder="Description" />
    <input type="text" [(ngModel)]="newClaim.procedurecode" placeholder="Procedure" />
    <input type="number" [(ngModel)]="newClaim.price" placeholder="Price" />
    <button class="add-claim-btn" (click)="addClaim()">Add Claim</button>
  </div>
</div>
